@{
    ViewData["Title"] = "Event Logs";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-3" style="margin-top: 7px;">
        <h1 class="fw-bold page-title mb-0">Event Logs</h1>
        <h3 class="timedate" id="liveDateTime"></h3>
    </div>

    <div class="card shadow-lg" style="border-radius: 12px; background: white;">
        <div class="table-responsive">
            <h3 class="card-text" style="padding: 18px 2px; margin: 0;">Alarm Logs</h3>
            <table class="table align-middle" style="font-size:16px;">
                <thead style="font-weight:bold;">
                    <tr>
                        <th>Date / Time</th>
                        <th>Alarm Title</th>
                        <th>Primary Name</th>
                        <th>Secondary Name</th>
                        <th>Alarm Description</th>
                    </tr>
                </thead>
                <tbody id="deviceTableBody" style="font-weight:600;">
                </tbody>
            </table>
        </div>
        <div class="pagination-wrapper">
            <div class="pagination-controls">
                <span>Page</span>
                <button class="Page-Number-icons"><i class="fas fa-chevron-left"></i></button>
                <span class="Page-Number">1</span>
                <button class="Page-Number-icons"><i class="fas fa-chevron-right"></i></button>
                <span>of 4 pages </span>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid" style="padding-top: 15px;"> 
    <div class="card shadow-lg" style="border-radius: 12px; background: white;">
        <div class="table-responsive">
            <h3 class="card-text" style="padding: 18px 2px; margin: 0;">Event Logs</h3>
            <table class="table align-middle" style="font-size:16px; margin-bottom:0; border-collapse:collapse;">

                <thead style="font-weight:bold;">
                    <tr>
                        <th>Date / Time</th>
                        <th>Name</th>
                        <th>Primary Name</th>
                        <th>Secondary Name</th>
                        <th>Alarm Description</th>
                    </tr>
                </thead>
                <tbody id="deviceTableBodyE" style="font-weight:600;">
                </tbody>
            </table>
        </div>
        <div class="pagination-wrapper">
            <div class="pagination-controls">
                <span>Page</span>
                <button class="Page-Number-icons"><i class="fas fa-chevron-left"></i></button>
                <span class="Page-Number">1</span>
                <button class="Page-Number-icons"><i class="fas fa-chevron-right"></i></button>
                <span>of 15 pages </span>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <script>
        // Active logs
        fetch('/data/EventLogs.json')
            .then(response => response.json())
            .then(data => {
                let tableBody = document.getElementById('deviceTableBody');
                tableBody.innerHTML = "";

                data.forEach(item => {
                    let row = `
                                        <tr style="height:40px;">
                                            <td>${item.DateTime}</td>
                                            <td>${item.AlarmTitle}</td>
                                            <td>${item.PrimaryName}</td>
                                            <td>${item.SecondaryName}</td>
                                            <td>${item.AlarmDescription}</td>
                                        </tr>
                                    `;
                    tableBody.innerHTML += row;
                });
            })
            .catch(error => console.error("Error loading JSON:", error));

        // Eventlogs
        fetch('/data/Eventlogs2.json')
            .then(response => response.json())
            .then(data => {
                let tableBody = document.getElementById('deviceTableBodyE');
                tableBody.innerHTML = "";

                data.forEach(item => {
                    let row = `
                                                <tr style="height:40px;">
                                                    <td>${item.dateTimeE}</td>
                                                    <td>${item.nameE}</td>
                                                    <td>${item.primaryNameE}</td>
                                                    <td>${item.secondaryNameE}</td>
                                                    <td>${item.descriptionE}</td>
                                                </tr>
                                            `;
                    tableBody.innerHTML += row;
                });
            })
            .catch(error => console.error("Error loading EventLogs JSON:", error));

        function updateLiveDateTime() {
            const now = new Date();

            const day = now.getDate().toString().padStart(2, '0');
            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const month = monthNames[now.getMonth()];
            const year = now.getFullYear();

            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');

            const formatted = `${day} ${month} ${year} ${hours}:${minutes}:${seconds}`;
            document.getElementById('liveDateTime').innerText = formatted;
        }

        setInterval(updateLiveDateTime, 1000);
        updateLiveDateTime();

    </script>
}
